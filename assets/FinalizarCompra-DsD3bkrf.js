import{d as e,e as a,j as t,B as s}from"./index-DIazkKjz.js";import{e as r,r as i}from"./react-9XyJl28y.js";import{E as l}from"./entrada-C9XhOSPw.js";import{L as n}from"./rotulo-C61-SxG8.js";import{G as d,I as o}from"./grupo-radio-BnOcfmVd.js";import{C as c}from"./cartao-ui-BIP3aJjB.js";import{m,w as x,k as p,y as u,z as b,B as h,D as v,Q as j}from"./vendor-B8aPdzC6.js";import"./index-DvwaLTDU.js";import"./index-ChjETHs9.js";import"./index-Dt0ohvky.js";const N=()=>{var N,y;r();const{user:g}=e(),{notificar:f}=a(),[k,C]=i.useState([]),[w,S]=i.useState(0),[z,E]=i.useState(15),[P,F]=i.useState(0),[R,$]=i.useState(1),[D,B]=i.useState([{id:"1",street:"Rua das Flores, 123",city:"Cidade Exemplo",state:"EX",zip:"12345-678",country:"Brasil",isDefault:!0},{id:"2",street:"Avenida Principal, 456",city:"Outra Cidade",state:"OC",zip:"98765-432",country:"Brasil",isDefault:!1}]),[q,I]=i.useState((null==(N=D.find((e=>e.isDefault)))?void 0:N.id)||(null==(y=D[0])?void 0:y.id)||""),[O,A]=i.useState(!1),[T,V]=i.useState({street:"",city:"",state:"",zip:"",country:"Brasil"}),[H,X]=i.useState("creditCard"),[M,Q]=i.useState({number:"",name:"",expiry:"",cvv:""});i.useEffect((()=>{const e=JSON.parse(localStorage.getItem("cart")||"[]");C(e);const a=e.reduce(((e,a)=>e+parseFloat(a.price.replace("R$ ","").replace(",","."))*a.quantity),0);S(a)}),[]),i.useEffect((()=>{F(w+z)}),[w,z]);const G=e=>{const{name:a,value:t}=e.target;let s=t;"number"===a?s=t.replace(/\D/g,"").replace(/(\d{4})/g,"$1 ").trim().slice(0,19):"expiry"===a?s=t.replace(/\D/g,"").replace(/(\d{2})(\d{0,2})/,"$1/$2").slice(0,5):"cvv"===a&&(s=t.replace(/\D/g,"").slice(0,3)),Q((e=>({...e,[a]:s})))},J=D.find((e=>e.id===q)),L=["Endereço","Pagamento","Revisão"];return t.jsxs(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"div-container div-espacada",children:[t.jsxs("div",{className:"flex items-center mb-6 sm:mb-8",children:[R>1&&t.jsx(s,{variant:"ghost",size:"icon",onClick:()=>$((e=>e-1)),className:"mr-2 text-brand-primary-kaline hover:bg-brand-primary-kaline/10",children:t.jsx(x,{className:"h-6 w-6"})}),t.jsx("h1",{className:"text-2xl sm:text-3xl font-bold font-heading text-brand-text-kaline",children:"Finalizar Compra"})]}),t.jsxs("div",{className:"mb-8",children:[t.jsx("div",{className:"flex justify-between mb-1",children:L.map(((e,a)=>t.jsx("span",{className:"text-xs sm:text-sm "+(a+1<=R?"text-brand-primary-kaline font-semibold":"text-brand-text-muted-kaline"),children:e},e)))}),t.jsx("div",{className:"w-full bg-muted rounded-full h-2",children:t.jsx(m.div,{className:"bg-brand-primary-kaline h-2 rounded-full",initial:{width:"0%"},animate:{width:R/L.length*100+"%"},transition:{duration:.5,ease:"easeInOut"}})})]}),t.jsx("div",{className:"div-espacada",children:t.jsxs("div",{className:"grid lg:grid-cols-3 gap-6 sm:gap-8",children:[t.jsx("div",{className:"lg:col-span-2 space-y-6",children:t.jsxs(p,{mode:"wait",children:[1===R&&t.jsx(m.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.3},children:t.jsxs(c,{className:"div-destaque div-arredondada div-sombra",children:[t.jsx(c.Header,{children:t.jsx(c.Title,{className:"text-xl sm:text-2xl text-brand-text-kaline",children:"Endereço de Entrega"})}),t.jsxs(c.Content,{className:"space-y-4",children:[t.jsx(d,{value:q,onValueChange:I,"aria-label":"Selecione o endereço de entrega",children:D.map((e=>t.jsxs(n,{htmlFor:`addr-${e.id}`,className:"flex items-start p-3 border rounded-md cursor-pointer transition-all "+(q===e.id?"border-brand-primary-kaline ring-2 ring-brand-primary-kaline bg-brand-primary-kaline/5":"border-input hover:border-brand-primary-kaline/50"),children:[t.jsx(o,{value:e.id,id:`addr-${e.id}`,className:"mt-1 mr-3 border-brand-primary-kaline text-brand-primary-kaline focus:ring-brand-primary-kaline"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"font-medium text-sm sm:text-base text-brand-text-kaline",children:e.street}),t.jsxs("p",{className:"text-xs sm:text-sm text-brand-text-muted-kaline",children:[e.city,", ",e.state," - ",e.zip]})]}),t.jsx(s,{variant:"ghost",size:"icon",onClick:a=>{var t,s,r;a.preventDefault(),a.stopPropagation(),t=e.id,B(D.filter((e=>e.id!==t))),q===t&&I((null==(s=D.find((e=>e.isDefault)))?void 0:s.id)||(null==(r=D[0])?void 0:r.id)||""),f({title:"Endereço Removido",variant:"destructive",duration:1500})},className:"text-destructive hover:text-destructive/80 h-7 w-7 sm:h-8 sm:w-8 ml-2",children:t.jsx(u,{className:"h-4 w-4"})})]},e.id)))}),t.jsxs(s,{variant:"outline",onClick:()=>A(!O),className:"w-full text-brand-primary-kaline border-brand-primary-kaline/50 hover:bg-brand-primary-kaline/10 text-sm",children:[t.jsx(b,{className:"mr-2 h-4 w-4"})," ",O?"Cancelar Novo Endereço":"Adicionar Novo Endereço"]}),O&&t.jsxs("form",{onSubmit:e=>{if(e.preventDefault(),!(T.street&&T.city&&T.state&&T.zip))return void f({title:"Ei, falta coisa aí!",description:"Preencha todos os campos, por favorzinho. A gente implora.",variant:"destructive",duration:2e3});const a={...T,id:Date.now().toString(),isDefault:0===D.length};B([...D,a]),I(a.id),V({street:"",city:"",state:"",zip:"",country:"Brasil"}),A(!1),f({title:"Endereço Adicionado!",duration:1500})},className:"space-y-3 pt-3 border-t border-border",children:[t.jsx(l,{placeholder:"Rua, Número, Bairro",value:T.street,onChange:e=>V({...T,street:e.target.value}),className:"text-sm"}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsx(l,{placeholder:"Cidade",value:T.city,onChange:e=>V({...T,city:e.target.value}),className:"text-sm"}),t.jsx(l,{placeholder:"Estado (UF)",value:T.state,onChange:e=>V({...T,state:e.target.value}),className:"text-sm"})]}),t.jsx(l,{placeholder:"CEP",value:T.zip,onChange:e=>V({...T,zip:e.target.value}),className:"text-sm"}),t.jsx(s,{type:"submit",className:"w-full btn-primary-kaline text-sm",children:"Salvar Endereço"})]})]})]})},"address-step"),2===R&&t.jsx(m.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.3},children:t.jsxs(c,{className:"div-destaque div-arredondada div-sombra",children:[t.jsx(c.Header,{children:t.jsx(c.Title,{className:"text-xl sm:text-2xl text-brand-text-kaline",children:"Forma de Pagamento"})}),t.jsxs(c.Content,{children:[t.jsx(d,{value:H,onValueChange:X,className:"space-y-3","aria-label":"Selecione a forma de pagamento",children:[{value:"creditCard",label:"Cartão de Crédito",icon:h},{value:"boleto",label:"Boleto Bancário",icon:v},{value:"pix",label:"PIX",icon:j}].map((e=>t.jsxs(n,{htmlFor:`payment-${e.value}`,className:"flex items-center p-3 border rounded-md cursor-pointer transition-all "+(H===e.value?"border-brand-primary-kaline ring-2 ring-brand-primary-kaline bg-brand-primary-kaline/5":"border-input hover:border-brand-primary-kaline/50"),children:[t.jsx(o,{value:e.value,id:`payment-${e.value}`,className:"mr-3 border-brand-primary-kaline text-brand-primary-kaline focus:ring-brand-primary-kaline"}),t.jsx(e.icon,{className:"h-5 w-5 mr-2 text-brand-text-muted-kaline"}),t.jsx("span",{className:"text-sm sm:text-base text-brand-text-kaline",children:e.label})]},e.value)))}),"creditCard"===H&&t.jsxs("div",{className:"mt-4 space-y-3 pt-3 border-t border-border",children:[t.jsx(l,{name:"number",placeholder:"Número do Cartão (0000 0000 0000 0000)",value:M.number,onChange:G,className:"text-sm"}),t.jsx(l,{name:"name",placeholder:"Nome no Cartão",value:M.name,onChange:G,className:"text-sm"}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsx(l,{name:"expiry",placeholder:"Validade (MM/AA)",value:M.expiry,onChange:G,className:"text-sm"}),t.jsx(l,{name:"cvv",placeholder:"CVV",value:M.cvv,onChange:G,className:"text-sm"})]})]}),"boleto"===H&&t.jsx("p",{className:"mt-4 text-sm text-brand-text-muted-kaline",children:"O boleto será gerado após a finalização do pedido."}),"pix"===H&&t.jsx("p",{className:"mt-4 text-sm text-brand-text-muted-kaline",children:"O QR Code para pagamento PIX será exibido após a finalização."})]})]})},"payment-step"),3===R&&t.jsx(m.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.3},children:t.jsxs(c,{className:"div-destaque div-arredondada div-sombra",children:[t.jsx(c.Header,{children:t.jsx(c.Title,{className:"text-xl sm:text-2xl text-brand-text-kaline",children:"Revisar Pedido"})}),t.jsxs(c.Content,{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold mb-1 text-brand-text-kaline",children:"Itens do Pedido:"}),k.map((e=>t.jsxs("div",{className:"flex justify-between items-center text-sm py-1 border-b border-border/50 last:border-b-0",children:[t.jsxs("span",{className:"text-brand-text-muted-kaline",children:[e.name," (x",e.quantity,")"]}),t.jsxs("span",{className:"text-brand-text-kaline",children:["R$ ",(parseFloat(e.price.replace("R$ ","").replace(",","."))*e.quantity).toFixed(2).replace(".",",")]})]},e.id+e.size+e.color)))]}),J&&t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold mb-1 text-brand-text-kaline",children:"Endereço de Entrega:"}),t.jsxs("p",{className:"text-sm text-brand-text-muted-kaline",children:[J.street,", ",J.city," - ",J.state,", ",J.zip]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold mb-1 text-brand-text-kaline",children:"Forma de Pagamento:"}),t.jsxs("p",{className:"text-sm text-brand-text-muted-kaline",children:["creditCard"===H&&`Cartão de Crédito final ${M.number.slice(-4)}`,"boleto"===H&&"Boleto Bancário","pix"===H&&"PIX"]})]})]})]})},"review-step")]})}),t.jsx("div",{className:"lg:col-span-1",children:t.jsxs(c,{className:"sticky top-24 div-destaque div-arredondada div-sombra shadow-lg",children:[t.jsx(c.Header,{children:t.jsx(c.Title,{className:"text-xl sm:text-2xl text-brand-text-kaline",children:"Resumo do Pedido"})}),t.jsxs(c.Content,{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-brand-text-muted-kaline",children:"Subtotal:"}),t.jsxs("span",{className:"text-brand-text-kaline",children:["R$ ",w.toFixed(2).replace(".",",")]})]}),t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-brand-text-muted-kaline",children:"Frete:"}),t.jsxs("span",{className:"text-brand-text-kaline",children:["R$ ",z.toFixed(2).replace(".",",")]})]}),t.jsxs("div",{className:"flex justify-between font-semibold text-base sm:text-lg pt-2 border-t border-border",children:[t.jsx("span",{className:"text-brand-text-kaline",children:"Total:"}),t.jsxs("span",{className:"text-brand-primary-kaline",children:["R$ ",P.toFixed(2).replace(".",",")]})]})]}),t.jsx(c.Footer,{children:R<3?t.jsx(s,{onClick:handleNextStep,className:"w-full btn-primary-kaline text-sm sm:text-base",children:1===R?"Continuar para Pagamento":"Revisar Pedido"}):t.jsx(s,{onClick:handlePlaceOrder,className:"w-full btn-primary-kaline bg-green-600 hover:bg-green-700 text-sm sm:text-base",children:"Finalizar Pedido e Pagar"})})]})})]})})]})};export{N as default};
//# sourceMappingURL=FinalizarCompra-DsD3bkrf.js.map
