import{j as e,a,B as r}from"./index-DIazkKjz.js";import{r as t,g as i,e as o}from"./react-9XyJl28y.js";import{E as s}from"./entrada-C9XhOSPw.js";import{L as d}from"./rotulo-C61-SxG8.js";import"./vendor-B8aPdzC6.js";import"./index-DvwaLTDU.js";const l=t.forwardRef((({className:r,...t},i)=>e.jsx("textarea",{className:a("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:i,...t})));l.displayName="AreaTexto";const c=()=>{const{produtoId:a}=i(),c=o(),{addProduto:m,updateProduto:n,getProdutoById:g}=useProdutos(),{notificar:u}=useNotificacao(),x=Boolean(a),[p,b]=t.useState({name:"",description:"",price:"",image:"",category:"",sizes:"",colors:""}),[I,h]=t.useState(!1);t.useEffect((()=>{if(x&&a){const e=g(a);e?b({name:e.name||"",description:e.description||"",price:e.price?e.price.replace("R$ ","").replace(",","."):"",image:e.image||"",category:e.category||"",sizes:e.sizes?e.sizes.join(", "):"",colors:e.colors?e.colors.join(", "):""}):(u({title:"Opa, deu ruim!",description:"Produto não encontrado. Vamos te levar de volta pra lista.",variant:"destructive"}),c("/vendedor/produtos"))}else{const e=localStorage.getItem("temp_product_image");e&&e.startsWith("data:image")&&b((a=>({...a,image:e})))}return()=>{p.name&&p.price&&localStorage.removeItem("temp_product_image")}}),[x,a,g,c,u]);const v=e=>{const{name:a,value:r}=e.target;b((e=>({...e,[a]:r})))};return e.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-2xl mx-auto px-2 sm:px-4 py-4 sm:py-8",children:[e.jsxs("div",{className:"flex items-center mb-6 sm:mb-8",children:[e.jsx(r,{variant:"ghost",size:"icon",onClick:()=>c("/seller/produtos"),className:"mr-2 text-brand-primary-kaline hover:bg-brand-primary-kaline/10",children:e.jsx(ChevronLeft,{className:"h-6 w-6"})}),e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold font-heading text-brand-text-kaline",children:x?"Editar Produto":"Adicionar Novo Produto"})]}),e.jsxs(Cartao,{className:"bg-brand-card-kaline dark:bg-card shadow-xl",children:[e.jsxs(CabecalhoCartao,{className:"flex flex-col sm:flex-row items-start sm:items-center gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs(TituloCartao,{className:"text-xl text-brand-text-kaline flex items-center",children:[x?e.jsx(Save,{className:"mr-2 h-5 w-5"}):e.jsx(PackagePlus,{className:"mr-2 h-5 w-5"}),"Detalhes do Produto"]}),p.name&&e.jsxs("p",{className:"text-sm text-brand-text-muted-kaline mt-1",children:[x?"Editando:":"Novo produto:"," ",e.jsx("span",{className:"font-medium",children:p.name})]})]}),p.image&&e.jsx("div",{className:"relative flex-shrink-0 w-16 h-16 rounded-md overflow-hidden border border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800",children:e.jsx("img",{src:p.image,alt:p.name||"Imagem do produto",className:"w-full h-full object-cover",onError:e=>{console.error("Erro ao carregar imagem no cabeçalho"),e.target.onerror=null,e.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjIwMCIgaGVpZ2h0PSIyMDAiIGZpbGw9IiNFRUVFRUUiLz48cGF0aCBkPSJNODQgMTI3TDY0IDEwN0w0NCAxMjciIHN0cm9rZT0iIzk5OTk5OSIgc3Ryb2tlLXdpZHRoPSI2IiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz48cGF0aCBkPSJNMTUyIDY0TDEzMiA0NEwxMTIgNjQiIHN0cm9rZT0iIzk5OTk5OSIgc3Ryb2tlLXdpZHRoPSI2IiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz48cGF0aCBkPSJNMTI4IDEyOEwxMDAgMTAwTDcyIDEyOCIgc3Ryb2tlPSIjOTk5OTk5IiBzdHJva2Utd2lkdGg9IjYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPjxjaXJjbGUgY3g9IjEwMCIgY3k9IjEwMCIgcj0iNTAiIHN0cm9rZT0iIzk5OTk5OSIgc3Ryb2tlLXdpZHRoPSI2Ii8+PC9zdmc+";const a=localStorage.getItem("temp_product_image");a&&a.startsWith("data:image")&&setTimeout((()=>{e.target.src=a,b((e=>({...e,image:a})))}),100)}})})]}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),h(!0),!p.name||!p.price||!p.category)return u({title:"Campos Obrigatórios",description:"Nome, preço e categoria são obrigatórios.",variant:"destructive",duration:3e3}),void h(!1);const r=parseFloat(p.price);if(isNaN(r)||r<=0)return u({title:"Preço Inválido",description:"Por favor, insira um preço válido.",variant:"destructive",duration:3e3}),void h(!1);const t={...p,price:`R$ ${r.toFixed(2).replace(".",",")}`,sizes:p.sizes.split(",").map((e=>e.trim())).filter((e=>e)),colors:p.colors.split(",").map((e=>e.trim())).filter((e=>e))};let i;i=x?await n(a,t):await m(t),h(!1),i&&i.success?(localStorage.removeItem("temp_product_image"),c("/seller/produtos"),u({title:x?"Produto atualizado!":"Produto adicionado!",description:`${p.name} foi ${x?"atualizado":"adicionado"} com sucesso.`,duration:3e3,className:"bg-green-500 text-white"})):console.error("Erro ao salvar o produto:",null==i?void 0:i.error)},children:[e.jsxs(ConteudoCartao,{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"name",className:"text-sm font-medium text-brand-text-kaline",children:"Nome do Produto*"}),e.jsx(s,{id:"name",name:"name",value:p.name,onChange:v,placeholder:"Ex: Vestido Floral Moderno",required:!0,className:"mt-1 bg-background dark:bg-input"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"description",className:"text-sm font-medium text-brand-text-kaline",children:"Descrição"}),e.jsx(l,{id:"description",name:"description",value:p.description,onChange:v,placeholder:"Detalhes sobre o produto...",rows:4,className:"mt-1 bg-background dark:bg-input"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-5",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"price",className:"text-sm font-medium text-brand-text-kaline",children:"Preço (R$)*"}),e.jsx(s,{id:"price",name:"price",type:"number",step:"0.01",value:p.price,onChange:v,placeholder:"Ex: 199.90",required:!0,className:"mt-1 bg-background dark:bg-input"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"category",className:"text-sm font-medium text-brand-text-kaline",children:"Categoria*"}),e.jsx(s,{id:"category",name:"category",value:p.category,onChange:v,placeholder:"Ex: Vestidos, Acessórios",required:!0,className:"mt-1 bg-background dark:bg-input"})]})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"image",className:"text-sm font-medium text-brand-text-kaline",children:"Imagem do Produto"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mt-1",children:[e.jsx("div",{children:e.jsxs("div",{className:"mb-2 p-2 border border-dashed border-gray-300 rounded-md bg-gray-50 dark:bg-gray-800",children:[e.jsxs("p",{className:"text-xs text-gray-500 mb-1",children:["A imagem será associada a: ",e.jsx("strong",{className:"text-brand-primary-kaline",children:p.name||"Nome do Produto"})]}),e.jsx(s,{id:"image",name:"image",type:"file",accept:"image/*",onChange:e=>{const a=e.target.files&&e.target.files[0];if(a){if(a.size>5242880)return void u({title:"Arquivo muito grande",description:"A imagem deve ter no máximo 5MB. Por favor, escolha uma imagem menor.",variant:"destructive",duration:5e3});const e=new FileReader;e.onloadend=()=>{try{const a=e.result;if(!a||!a.startsWith("data:image"))throw new Error("Formato de imagem inválido");b((e=>{const r={...e,image:a};return localStorage.setItem("temp_product_image",a),r})),u({title:"Imagem associada ao produto",description:`A imagem foi carregada com sucesso e será associada a "${p.name||"este produto"}" em todas as visualizações.`,duration:3e3})}catch(a){console.error("Erro ao processar imagem:",a),u({title:"Ops!",description:"Não é você, sou eu ;(",description:"Formato de imagem inválido ou corrompido. Tente novamente.",variant:"destructive",duration:3e3})}},e.onerror=()=>{u({title:"Ops!",description:"Não é você, sou eu ;(",variant:"destructive",duration:3e3})},e.readAsDataURL(a)}},className:"bg-background dark:bg-input"}),e.jsx("p",{className:"text-xs text-brand-text-muted-kaline mt-1",children:"Formatos aceitos: JPG, PNG, GIF (máx. 5MB)"})]})}),e.jsx("div",{className:"flex items-center justify-center border border-dashed border-input rounded-md p-2 h-32 bg-gray-50 dark:bg-gray-800",children:p.image?e.jsx("div",{className:"relative w-full h-full flex items-center justify-center",children:e.jsx("img",{src:p.image,alt:"Prévia da Imagem",className:"max-h-full max-w-full object-contain",onError:e=>{console.error("Erro ao carregar imagem de prévia"),e.target.onerror=null,e.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjIwMCIgaGVpZ2h0PSIyMDAiIGZpbGw9IiNFRUVFRUUiLz48cGF0aCBkPSJNODQgMTI3TDY0IDEwN0w0NCAxMjciIHN0cm9rZT0iIzk5OTk5OSIgc3Ryb2tlLXdpZHRoPSI2IiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz48cGF0aCBkPSJNMTUyIDY0TDEzMiA0NEwxMTIgNjQiIHN0cm9rZT0iIzk5OTk5OSIgc3Ryb2tlLXdpZHRoPSI2IiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz48cGF0aCBkPSJNMTI4IDEyOEwxMDAgMTAwTDcyIDEyOCIgc3Ryb2tlPSIjOTk5OTk5IiBzdHJva2Utd2lkdGg9IjYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPjxjaXJjbGUgY3g9IjEwMCIgY3k9IjEwMCIgcj0iNTAiIHN0cm9rZT0iIzk5OTk5OSIgc3Ryb2tlLXdpZHRoPSI2Ii8+PC9zdmc+"}})}):e.jsxs("div",{className:"text-center text-brand-text-muted-kaline text-sm",children:[e.jsx("p",{children:"Prévia da imagem"}),e.jsx("p",{className:"text-xs",children:"Nenhuma imagem selecionada"})]})})]})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"sizes",className:"text-sm font-medium text-brand-text-kaline",children:"Tamanhos (separados por vírgula)"}),e.jsx(s,{id:"sizes",name:"sizes",value:p.sizes,onChange:v,placeholder:"Ex: P, M, G, GG",className:"mt-1 bg-background dark:bg-input"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"colors",className:"text-sm font-medium text-brand-text-kaline",children:"Cores (separadas por vírgula)"}),e.jsx(s,{id:"colors",name:"colors",value:p.colors,onChange:v,placeholder:"Ex: Rosa Floral, Azul Céu, Preto",className:"mt-1 bg-background dark:bg-input"})]})]}),e.jsx(RodapeCartao,{children:e.jsx(r,{type:"submit",className:"w-full btn-primary-kaline text-sm sm:text-base",disabled:I,children:I?x?"Salvando Alterações...":"Adicionando Produto...":x?"Salvar Alterações":"Adicionar Produto"})})]})]})]})};export{c as default};
//# sourceMappingURL=FormularioProduto-BTF6X3ZI.js.map
