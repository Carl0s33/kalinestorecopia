{"version":3,"file":"Carrinho-CVWkV7ZF.js","sources":["../../src/pages/Carrinho.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Botao } from '@/components/ui/botao';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { Link } from 'react-router-dom';\nimport { ShoppingCart, Trash2, Plus, Minus } from 'lucide-react';\nimport { useNotificacao } from \"@/components/ui/useNotificacao\";\n\n// página do carrinho de compras\n// se o carrinho estiver vazio, chora\nconst CartPage = () => {\n  // itens do carrinho\n  // começa vazio e só enche quando o usuário coloca algo\n  const [cartItems, setCartItems] = useState([]);\n  const { notificar } = useNotificacao();\n\n  // tenta carregar o carrinho do localStorage\n  // se der erro, começa vazio e foda-se\n  // calcula o total da compra\n  // se der erro, o produto é de graça\n  const loadCart = () => {\n    try {\n      const storedCart = JSON.parse(localStorage.getItem('cart') || '[]');\n      if (Array.isArray(storedCart)) {\n        setCartItems(storedCart);\n      } else {\n        setCartItems([]);\n      }\n    } catch (error) {\n      console.error('Erro ao carregar o carrinho:', error);\n      setCartItems([]);\n    }\n  };\n\n  // quando o componente monta, carrega o carrinho\n  // e fica escutando atualizações\n  // se der pau, já era\n  useEffect(() => {\n    loadCart();\n    window.addEventListener('cartUpdated', loadCart);\n    return () => window.removeEventListener('cartUpdated', loadCart);\n  }, []);\n\n  // atualiza o carrinho no localStorage\n  // se der erro, o usuário perdeu o carrinho e chora\n  const updateCartInStorage = (updatedCart) => {\n    try {\n      localStorage.setItem('cart', JSON.stringify(updatedCart));\n      setCartItems(updatedCart);\n      window.dispatchEvent(new CustomEvent('cartUpdated'));\n    } catch (error) {\n      console.error('Erro ao salvar o carrinho:', error);\n    }\n  };\n\n  // remove um item do carrinho\n  // se o usuário se arrepender, paciência\n  const handleRemoveItem = (itemId, itemSize, itemColor) => {\n    const updatedCart = cartItems.filter(\n      item => !(item.id === itemId && item.size === itemSize && item.color === itemColor)\n    );\n    updateCartInStorage(updatedCart);\n    notificar({\n      title: \"Item removido!\",\n      description: \"O produto foi removido do seu carrinho.\",\n      variant: \"destructive\",\n      duration: 2000,\n    });\n  };\n\n  // atualiza a quantidade de um item\n  // se colocar 0, é a mesma coisa que remover\n  // mas o usuário não sabe disso\n  const handleQuantityChange = (itemId, itemSize, itemColor, newQuantity) => {\n    if (newQuantity < 1) {\n      handleRemoveItem(itemId, itemSize, itemColor);\n      return;\n    }\n    const updatedCart = cartItems.map(item =>\n      item.id === itemId && item.size === itemSize && item.color === itemColor\n        ? { ...item, quantity: newQuantity }\n        : item\n    );\n    updateCartInStorage(updatedCart);\n  };\n\n  const subtotal = cartItems.reduce((sum, item) => {\n    const price = parseFloat(item.price?.replace('R$ ', '')?.replace(',', '.') || '0');\n    const quantity = item.quantity || 0;\n    return sum + price * quantity;\n  }, 0);\n\n  const defaultImage = \"https://images.unsplash.com/photo-1600577916048-85e976972793?w=100&h=100&fit=crop\";\n\n  return (\n    <motion.div\n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      transition={{ duration: 0.5 }}\n      className=\"max-w-4xl mx-auto px-2 sm:px-4 py-4 sm:py-8\"\n    >\n      <div className=\"flex items-center justify-center mb-6 sm:mb-8\">\n        <h1 className=\"text-2xl sm:text-3xl font-bold font-heading text-brand-text-kaline\">\n          Meu Carrinho\n        </h1>\n        <ShoppingCart className=\"ml-2 h-7 w-7 sm:h-8 sm:w-8 text-brand-primary-kaline\" />\n      </div>\n\n      {/* se o carrinho estiver vazio\n          mostra uma mensagem triste */}\n      {cartItems.length === 0 ? (\n        <motion.div\n          initial={{ opacity: 0, scale: 0.9 }}\n          animate={{ opacity: 1, scale: 1 }}\n          className=\"text-center py-10 sm:py-12 bg-brand-card-kaline dark:bg-card rounded-lg shadow-lg\"\n        >\n          <ShoppingCart className=\"h-16 w-16 sm:h-20 sm:w-20 text-brand-text-muted-kaline dark:text-muted-foreground mx-auto mb-4 sm:mb-6\" />\n          <p className=\"text-lg sm:text-xl text-brand-text-muted-kaline dark:text-muted-foreground mb-3 sm:mb-4\">\n            Seu carrinho está vazio.\n          </p>\n          <Botao asChild className=\"btn-primary-kaline rounded-md text-sm\">\n            <Link to=\"/\">Continuar Comprando</Link>\n          </Botao>\n        </motion.div>\n      ) : (\n        <div className=\"space-y-4 sm:space-y-6\">\n          <div className=\"bg-brand-card-kaline dark:bg-card p-4 sm:p-6 rounded-lg shadow-lg\">\n            <AnimatePresence>\n              {cartItems.map((item, index) => (\n                <motion.div\n                  key={`${item.id}-${item.size}-${item.color}`}\n                  layout\n                  initial={{ opacity: 0, y: 10 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  exit={{ opacity: 0, x: -20, transition: { duration: 0.2 } }}\n                  transition={{ duration: 0.3, delay: index * 0.05 }}\n                  className=\"flex flex-col sm:flex-row items-center justify-between py-3 sm:py-4 border-b border-border/60 last:border-b-0\"\n                >\n                  <div className=\"flex items-center space-x-3 sm:space-x-4 mb-3 sm:mb-0 flex-grow w-full sm:w-auto\">\n                    <img\n                      src={item.image && item.image.startsWith('http') ? item.image : defaultImage}\n                      alt={item.name}\n                      className=\"w-16 h-20 sm:w-20 sm:h-24 object-cover rounded-md bg-muted\"\n                      onError={e => { e.target.onerror = null; e.target.src = defaultImage; }}\n                    />\n                    <div className=\"min-w-0\">\n                      <Link\n                        to={`/product/${item.id}`}\n                        className=\"font-semibold text-sm sm:text-base text-brand-text-kaline dark:text-brand-text-kaline hover:underline truncate block\"\n                        title={item.name}\n                      >\n                        {item.name}\n                      </Link>\n                      <p className=\"text-xs sm:text-sm text-brand-text-muted-kaline dark:text-muted-foreground\">\n                        {item.size && `Tam: ${item.size}`} {item.color && item.size && ` - `}{item.color && `Cor: ${item.color}`}\n                      </p>\n                      <p className=\"text-xs sm:text-sm text-brand-text-muted-kaline dark:text-muted-foreground sm:hidden mt-1\">\n                        {item.price}\n                      </p>\n                    </div>\n                  </div>\n                  <div className=\"flex items-center space-x-2 sm:space-x-4 w-full sm:w-auto justify-between sm:justify-end\">\n                    <div className=\"flex items-center border border-input rounded-md\">\n                      <Botao\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={() => handleQuantityChange(item.id, item.size, item.color, item.quantity - 1)}\n                        className=\"px-2 h-8 w-8 rounded-r-none text-brand-primary-kaline hover:bg-brand-primary-kaline/10\"\n                      >\n                        <Minus className=\"h-3.5 w-3.5\" />\n                      </Botao>\n                      <span className=\"px-2 sm:px-3 text-xs sm:text-sm w-8 text-center\">{item.quantity}</span>\n                      <Botao\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={() => handleQuantityChange(item.id, item.size, item.color, item.quantity + 1)}\n                        className=\"px-2 h-8 w-8 rounded-l-none text-brand-primary-kaline hover:bg-brand-primary-kaline/10\"\n                      >\n                        <Plus className=\"h-3.5 w-3.5\" />\n                      </Botao>\n                    </div>\n                    <p className=\"font-semibold text-sm sm:text-base text-brand-text-kaline dark:text-brand-text-kaline w-20 sm:w-24 text-right\">\n                      {(item.price * item.quantity).toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}\n                    </p>\n                    <Botao\n                      variant=\"ghost\"\n                      size=\"icon\"\n                      onClick={() => handleRemoveItem(item.id, item.size, item.color)}\n                      className=\"text-destructive hover:text-destructive/80 hover:bg-destructive/10 rounded-full h-8 w-8\"\n                    >\n                      <Trash2 className=\"h-4 w-4 sm:h-5 sm:w-5\" />\n                    </Botao>\n                  </div>\n                </motion.div>\n              ))}\n            </AnimatePresence>\n          </div>\n\n          <div className=\"bg-brand-card-kaline dark:bg-card p-4 sm:p-6 rounded-lg shadow-lg flex flex-col sm:flex-row justify-between items-center gap-3 sm:gap-4\">\n            <div className=\"text-center sm:text-left\">\n              <p className=\"text-lg sm:text-xl font-semibold text-brand-text-kaline dark:text-brand-text-kaline\">\n                Subtotal: R$ {subtotal.toFixed(2).replace('.', ',')}\n              </p>\n              <p className=\"text-xs sm:text-sm text-brand-text-muted-kaline dark:text-muted-foreground\">\n                Taxas e frete serão calculados no checkout.\n              </p>\n            </div>\n            <Botao size=\"lg\" className=\"btn-primary-kaline rounded-md text-sm sm:text-base w-full sm:w-auto\" asChild>\n              <Link to=\"/checkout\">Finalizar Compra</Link>\n            </Botao>\n          </div>\n        </div>\n      )}\n    </motion.div>\n  );\n};\n\nexport default CartPage;\n"],"names":["CartPage","cartItems","setCartItems","useState","notificar","useNotificacao","loadCart","storedCart","JSON","parse","localStorage","getItem","Array","isArray","error","console","useEffect","window","addEventListener","removeEventListener","updateCartInStorage","updatedCart","setItem","stringify","dispatchEvent","CustomEvent","handleRemoveItem","itemId","itemSize","itemColor","filter","item","id","size","color","title","description","variant","duration","handleQuantityChange","newQuantity","map","quantity","subtotal","reduce","sum","parseFloat","_b","_a","price","replace","defaultImage","jsxRuntimeExports","jsxs","motion","div","initial","opacity","animate","transition","className","children","jsx","ShoppingCart","length","scale","Botao","asChild","Link","to","AnimatePresence","index","layout","y","exit","x","delay","src","image","startsWith","alt","name","onError","e","target","onerror","onClick","Minus","Plus","toLocaleString","style","currency","Trash2","toFixed"],"mappings":"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"}